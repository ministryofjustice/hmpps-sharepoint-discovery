#!/bin/bash
# Run Ruff for Python formatting and enforce no issues before commit

# Check staged Python files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.py$')

if [ -z "$STAGED_FILES" ]; then
  echo "No Python files to lint."
  exit 0
fi

# Run Ruff to fix issues
echo "Running Ruff on staged files..."
ruff check $STAGED_FILES --diff

# Check if Ruff found any issues
if [ $? -ne 0 ]; then
  echo "Ruff found issues. Please fix them before committing."
  exit 1
else
  echo "Ruff passed. Proceeding with commit."
fi
